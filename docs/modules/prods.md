# Модуль Prods (Производители)

## Описание модуля

Модуль `prods` решает задачи учёта производителей. Он обеспечивает хранение справочника производителей с ключом-идентификатором (name), полным названием и ссылкой на изображение, а также CRUD-операции для управления этим справочником.

## Сущности модуля

### Prod (Производитель)

Производитель — справочная сущность, представляющая бренд или компанию-производителя. Документ содержит поле `name` — уникальный строковый ключ (slug), по которому производителя можно однозначно найти; `title` — полное общепринятое название; `imageUrl` — ссылка на изображение (логотип или иное). Идентификатор документа генерируется MongoDB (`_id`). Документ имеет стандартные временные метки создания и обновления.

## Связи между сущностями

На текущий момент модуль не имеет явных связей с другими сущностями системы. Поле `name` может использоваться в других модулях как внешний ключ для привязки к производителю.

## Концепции и принятые решения

### Уникальность name

Поле `name` является уникальным ключом. Это позволяет получать производителя по имени (эндпоинт getProdByName) и гарантирует отсутствие дубликатов по ключу. При создании и обновлении дубликат `name` приводит к ошибке валидации со стороны БД.

### Частичное обновление

Эндпоинт updateProdById принимает в теле запроса только те поля, которые нужно изменить (`name`, `title`, `imageUrl` — все опциональны). Обновляются лишь переданные поля; непереданные остаются без изменений.

### Роли доступа

Чтение (получение по id, по name, список всех) доступно роли USER и выше. Создание и обновление — роли ADMIN. Удаление производителя разрешено только роли PRIME, по аналогии с другими критичными операциями удаления в системе.

## API эндпоинты

### GET `/api/prods`

Получение списка всех производителей (сортировка по дате создания, сначала новые).

**Запрос:**

- Query параметры отсутствуют

**Ответ:**

- 200: `{ message: string, data: Array<Prod> }`
- 500: `{ message: string, error?: any }` — ошибка сервера

**Доступ:** Требует роль USER

### GET `/api/prods/id/:id`

Получение производителя по идентификатору.

**Запрос:**

- Path параметры: `id` (MongoDB ObjectId)

**Ответ:**

- 200: `{ message: string, data: Prod }`
- 400: `{ message: string, errors?: array }` — ошибка валидации
- 404: `{ message: string }` — производитель не найден
- 500: `{ message: string, error?: any }` — ошибка сервера

**Доступ:** Требует роль USER

### GET `/api/prods/name/:name`

Получение производителя по ключу name.

**Запрос:**

- Path параметры: `name` (string)

**Ответ:**

- 200: `{ message: string, data: Prod }`
- 400: `{ message: string, errors?: array }` — ошибка валидации
- 404: `{ message: string }` — производитель не найден
- 500: `{ message: string, error?: any }` — ошибка сервера

**Доступ:** Требует роль USER

### POST `/api/prods`

Создание производителя.

**Запрос:**

- Body: `{ name: string, title: string, imageUrl: string }`

**Ответ:**

- 201: `{ message: string, data: Prod }`
- 400: `{ message: string, errors?: array }` — ошибка валидации
- 500: `{ message: string, error?: any }` — ошибка сервера (в т.ч. при дубликате name)

**Доступ:** Требует роль ADMIN

### PATCH `/api/prods/id/:id`

Обновление производителя по id. В теле передаются только поля, которые нужно изменить.

**Запрос:**

- Path параметры: `id` (MongoDB ObjectId)
- Body: опционально `{ name?: string, title?: string, imageUrl?: string }`

**Ответ:**

- 200: `{ message: string, data: Prod }`
- 400: `{ message: string, errors?: array }` — ошибка валидации
- 404: `{ message: string }` — производитель не найден
- 500: `{ message: string, error?: any }` — ошибка сервера

**Доступ:** Требует роль ADMIN

### DELETE `/api/prods/id/:id`

Удаление производителя по id.

**Запрос:**

- Path параметры: `id` (MongoDB ObjectId)

**Ответ:**

- 200: `{ message: string }`
- 400: `{ message: string, errors?: array }` — ошибка валидации
- 404: `{ message: string }` — производитель не найден
- 500: `{ message: string, error?: any }` — ошибка сервера

**Доступ:** Требует роль PRIME

## Формат данных Prod

- `_id`: string (MongoDB ObjectId)
- `name`: string — уникальный ключ
- `title`: string — полное название
- `imageUrl`: string — ссылка на изображение
- `createdAt`: Date
- `updatedAt`: Date
