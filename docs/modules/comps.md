# Модуль Comps

## Описание модуля

Модуль `comps` решает задачи работы с внешними источниками данных. Он обеспечивает получение информации о товарах с внешних сайтов (sharik.ua), парсинг HTML страниц для извлечения данных о товарах, и предоставляет утилиты для интеграции с внешними системами. Модуль является вспомогательным и используется другими модулями (arts, defs) для получения актуальной информации о товарах из внешних источников.

## Сущности модуля

Модуль не содержит собственных сущностей, так как является утилитарным модулем. Он предоставляет функции для работы с внешними источниками данных.

## Связи между сущностями

Модуль не имеет прямых связей с другими модулями через базу данных. Он используется другими модулями через импорт функций.

## Концепции и принятые решения

### Парсинг внешних сайтов

Модуль использует библиотеку cheerio для парсинга HTML страниц внешних сайтов. Это позволяет извлекать данные о товарах (название, цена, количество) из HTML разметки без необходимости использования официального API.

### Получение данных с sharik.ua

Основная функция модуля - получение данных о товарах с сайта sharik.ua по артикулу. Функция выполняет HTTP запрос к странице поиска, парсит HTML для извлечения информации о первом найденном товаре, и возвращает структурированные данные.

### Обработка ошибок

Модуль обрабатывает различные типы ошибок: отсутствие товара, неполные данные, ошибки парсинга, ошибки сети. В случае ошибки функция возвращает null или выбрасывает исключение с описанием проблемы.

### Валидация данных

Модуль валидирует полученные данные перед возвратом. Если данные неполные или некорректные, функция возвращает null или выбрасывает исключение.

### Форматирование данных

Модуль форматирует полученные данные (цена, количество) для удобства использования. Цена извлекается из текста и преобразуется в число, количество извлекается из текста и преобразуется в целое число.

### Кэширование

Модуль не реализует кэширование данных, так как это должно быть сделано на уровне вызывающих модулей. Это позволяет гибко управлять кэшированием в зависимости от требований конкретного модуля.

### Изоляция внешних зависимостей

Модуль изолирует работу с внешними источниками данных, что позволяет легко заменять источники или добавлять новые без изменения других модулей.

## API эндпоинты

Модуль не предоставляет API эндпоинтов, так как является внутренним утилитарным модулем. Функции модуля используются другими модулями через импорт.

## Форматы данных

### SharikProductInfo

```typescript
{
  nameukr: string;                 // Название товара на украинском
  price: number;                   // Цена товара
  quantity: number;                // Количество товара на витрине
}
```

